<ng-template #rt let-r="result" let-t="term">
  {{ r.nome }}
</ng-template>
<ng-template #rtFantasia let-r="result" let-t="term">
  {{ r.fantasia }}
</ng-template>

<div class="col-12 venda-div-principal" style="padding: 15px; margin: 0px">
  <app-page-header
    [pheading]="' Vendas'"
    [picon]="'fa-shopping-cart'"
    [heading]="'Venda'"
    [icon]="'fa-th-list'"
  >
  </app-page-header>

  <div class="card div-geral-page" style="padding-top: 15px">
    <ngx-spinner
      class="spinner-full"
      name="fullSpinner"
      [fullScreen]="false"
      bdColor="rgba(51,51,51,0.8)"
      size="medium"
      color="#fff"
      type="ball-spin-clockwise"
    >
      <p style="font-size: 20px; color: white">
        Comunicando com o Servidor, Aguarde...
      </p>
    </ngx-spinner>

    <div
      class="alert alert-acesso"
      [ngClass]="
        permitVendaServer.vendaBloqueada ? 'alert-danger' : 'alert-info'
      "
    >
      <span
        class="fa fa-refresh fa-spin fa-fw span-pesq-alert"
        *ngIf="permitVendaServer.statusConsultando"
      ></span
      ><span class="span-info-alert">{{ getMsgPermitVenda() }}</span>
    </div>

    <div class="alert alert-info alert-acesso">
      <span class="span-info-alert">{{ getAlertInfo() }}</span>
    </div>

    <div *ngIf="statusForm === 1 || statusForm === 2" class="margin-padding-0">
      <div class="card bg-light mb-3">
        <div class="card-body card-buttons">
          <div class="row">
            <div class="col-lg-3 col-6 div-mobile-buttons d-grid">
              <button
                class="btn btn-block butao-acao"
                [ngClass]="statusForm === 2 ? 'btn-warning' : 'btn-primary'"
                [disabled]="isDisableSalvaAtualiza()"
                (click)="onCadastra()"
              >
                <span class="fa fa-save span-bt-icon"></span
                ><span class="span-bt-text">{{
                  statusForm === 2 ? "Alterar" : "Salvar"
                }}</span>
              </button>
            </div>
            <div class="col-lg-2 col-6 div-mobile-buttons d-grid">
              <button
                type="button"
                class="btn btn-outline-dark butao-acao"
                (click)="onLimpa()"
              >
                <span class="fa fa-eraser span-bt-icon"></span
                ><span class="span-bt-text">Limpar</span>
              </button>
            </div>
            <div class="col-lg-1 col-4 div-mobile-buttons d-grid">
              <button
                type="button"
                class="btn btn-block btn-info butao-acao"
                (click)="onLeftArray()"
              >
                <span class="fa fa-arrow-circle-left span-bt-icon"></span>
              </button>
            </div>
            <div class="col-lg-1 col-4 div-mobile-buttons d-grid">
              <button
                type="button"
                class="btn btn-block btn-info butao-acao"
                (click)="onRightArray()"
              >
                <span class="fa fa-arrow-circle-right span-bt-icon"></span>
              </button>
            </div>
            <div class="col-lg-1 col-4 div-mobile-buttons d-grid">
              <button
                type="button"
                class="btn btn-block btn-info butao-acao"
                (click)="onTable()"
              >
                <span class="fa fa-table span-bt-icon"></span>
              </button>
            </div>
            <div class="col-lg-2 col-6 div-mobile-buttons d-grid">
              <button
                type="button"
                class="btn btn-block btn-danger butao-acao"
                (click)="onDeleta()"
              >
                <span class="fa fa-trash span-bt-icon"></span
                ><span class="span-bt-text">Deletar</span>
              </button>
            </div>
            <div class="col-lg-2 col-6 div-mobile-buttons d-grid">
              <button
                type="button"
                class="btn btn-block btn-success butao-acao"
                (click)="onPesquisa()"
              >
                <span class="fa fa-search span-bt-icon"></span
                ><span class="span-bt-text">Pesquisar</span>
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="card bg-light mb-3" *ngIf="isAcoesVisiveis()">
        <div class="card-body card-buttons">
          <div class="row">
            <div
              class="col-lg-3 col-12 div-mobile-buttons d-grid"
              *ngIf="isBotaoConfirmar()"
            >
              <button
                class="btn btn-outline-dark butao-acao"
                (click)="confirmaVenda()"
              >
                <span class="fa fa-check span-bt-icon"></span
                ><span class="span-bt-text">Confirmar</span>
              </button>
            </div>
            <div
              class="col-lg-3 col-12 div-mobile-buttons d-grid"
              *ngIf="isBotaoValidar()"
            >
              <button
                class="btn btn-outline-dark butao-acao"
                (click)="validaVenda()"
              >
                <span class="fa fa-check span-bt-icon"></span
                ><span class="span-bt-text">Validar</span>
              </button>
            </div>
            <div
              class="col-lg-3 col-12 div-mobile-buttons d-grid"
              *ngIf="isBotaoAprovar()"
            >
              <button
                class="btn btn-outline-dark butao-acao"
                (click)="aprovaVenda()"
              >
                <span class="fa fa-gavel span-bt-icon"></span
                ><span class="span-bt-text">Aprovar</span>
              </button>
            </div>

            <div
              class="col-lg-3 col-12 div-mobile-buttons d-grid"
              *ngIf="isBotaoFaturar()"
            >
              <button
                class="btn btn-outline-dark butao-acao"
                (click)="faturaVenda()"
              >
                <span class="fa fa-money span-bt-icon"></span
                ><span class="span-bt-text">Faturar</span>
              </button>
            </div>

            <div
              class="col-lg-3 col-12 div-mobile-buttons d-grid"
              *ngIf="isBotaoDesFaturar()"
            >
              <button
                class="btn btn-outline-dark butao-acao"
                (click)="desFaturaVenda()"
              >
                <span class="fa fa-ban span-bt-icon"></span
                ><span class="span-bt-text">Cancelar Faturamento</span>
              </button>
            </div>
            <div
              class="col-lg-3 col-12 div-mobile-buttons d-grid"
              *ngIf="isBotaoCancelar()"
            >
              <button
                class="btn btn-outline-dark butao-acao"
                (click)="cancelarVenda()"
              >
                <span class="fa fa-ban span-bt-icon"></span
                ><span class="span-bt-text">Cancelar</span>
              </button>
            </div>
            
            <div
            class="col-lg-3 col-12 div-mobile-buttons d-grid"
            *ngIf="isBotaoAssumirCaixa()"
          >
            <button
              class="btn btn-outline-dark butao-acao"
              (click)="assumirCaixa()"
            >
              <span class="fa fa-bolt span-bt-icon"></span
              ><span class="span-bt-text">Assumir Caixa</span>
            </button>
          </div>

          <div
          class="col-lg-3 col-12 div-mobile-buttons d-grid"
          *ngIf="isBotaoMarcarCarregado()"
        >
          <button
            class="btn btn-outline-dark butao-acao"
            (click)="marcarCarregado()"
          >
            <span class="fa fa-bolt span-bt-icon"></span
            ><span class="span-bt-text">Marcar como Carregado/Romaneio</span>
          </button>
        </div>

        <div
        class="col-lg-3 col-12 div-mobile-buttons d-grid"
        *ngIf="isBotaoMarcarAguardandoCarregamento()"
      >
        <button
          class="btn btn-outline-dark butao-acao"
          (click)="marcarAguardandoCarregamento()"
        >
          <span class="fa fa-bolt span-bt-icon"></span
          ><span class="span-bt-text">Marcar como Aguardando Carregamento</span>
        </button>
      </div>


            <div
              class="col-lg-3 col-12 div-mobile-buttons d-grid"
              *ngIf="isBotaoDesConfirmar()"
            >
              <button
                class="btn btn-outline-dark butao-acao"
                (click)="desconfirmarVenda()"
              >
                <span class="fa fa-ban span-bt-icon"></span
                ><span class="span-bt-text">Desconfirmar</span>
              </button>
            </div>
            <div
              class="col-lg-3 col-12 div-mobile-buttons d-grid"
              *ngIf="isBotaoPrint()"
            >
              <button
                class="btn btn-outline-dark butao-acao"
                (click)="openPrintPage()"
              >
                <span class="fa fa-print span-bt-icon"></span
                ><span class="span-bt-text">Imprimir</span>
              </button>
            </div>
            <div
              class="col-lg-3 col-12 div-mobile-buttons d-grid"
              *ngIf="isBotaoPrint()"
            >
              <button
                class="btn btn-outline-dark butao-acao"
                (click)="openPrintTermalPage()"
              >
                <span class="fa fa-print span-bt-icon"></span
                ><span class="span-bt-text">Cupom</span>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!--
    <div class="card bg-light mb-3">
        <div class="card-body padding-5">
            <div class="row">
                    <div class="col-2 text-center"
                    [ngClass]="statusCompleteClass('CC') ? 'div-span-status-complete':'div-span-status-wait'">
                    <div><span class="fa span-status"
                            [ngClass]="statusCompleteClass('CC') ? 'fa-check':'fa-clock-o'"></span>
                    </div>
                    <div>CC</div>
                </div>
                <div class="col-2 text-center"
                    [ngClass]="statusCompleteClass('AB') ? 'div-span-status-complete':'div-span-status-wait'">
                    <div><span class="fa span-status"
                            [ngClass]="statusCompleteClass('AB') ? 'fa-check':'fa-clock-o'"></span>
                    </div>
                    <div>AB</div>
                </div>
                <div class="col-2 text-center"
                    [ngClass]="statusCompleteClass('CF') ? 'div-span-status-complete':'div-span-status-wait'">
                    <div><span class="fa span-status"
                            [ngClass]="statusCompleteClass('CF') ? 'fa-check':'fa-clock-o'"></span>
                    </div>
                    <div>CF</div>
                </div>
                <div class="col-2 text-center"
                    [ngClass]="statusCompleteClass('AP') ? 'div-span-status-complete':'div-span-status-wait'">
                    <div><span class="fa span-status"
                            [ngClass]="statusCompleteClass('AP') ? 'fa-check':'fa-clock-o'"></span>
                    </div>
                    <div>AP</div>
                </div>

                <div class="col-2 text-center"
                    [ngClass]="statusCompleteClass('FA') ? 'div-span-status-complete':'div-span-status-wait'">
                    <div><span class="fa span-status"
                            [ngClass]="statusCompleteClass('FA') ? 'fa-check':'fa-clock-o'"></span>
                    </div>
                    <div>FA</div>
                </div>
                <div class="col-2 text-center"
                    [ngClass]="statusCompleteClass('TM') ? 'div-span-status-complete':'div-span-status-wait'">
                    <div><span class="fa span-status"
                            [ngClass]="statusCompleteClass('TM') ? 'fa-check':'fa-clock-o'"></span>
                    </div>
                    <div>TM</div>
                </div>
            </div>
        </div>
    </div>
-->

      <div class="card bg-light mb-3">
        <div class="card-body padding-5">
          <form [formGroup]="pedidoForm" (ngSubmit)="onCadastra()">

            <div ngbAccordion>
              <div ngbAccordionItem [collapsed]="true">
                  <h2 ngbAccordionHeader>
                      <button ngbAccordionButton>CAMPOS DE PESQUISA ADICIONAIS</button>
                  </h2>

                  <div ngbAccordionCollapse>
                      <div ngbAccordionBody>
                        <ng-template >
                          <div class="row">

                            <div class="col-sm-12 col-12 padding-5">
                              <div class="form-group">
                                <label class="label-select-custom" for="idSelectStatus"
                                  >Filtro de Status</label
                                >
                                <ng-select
                                  class="select-custom"
                                  [multiple]="true"
                                  [items]="vendaStatusLabels"
                                  bindLabel="label"
                                  [closeOnSelect]="true"
                                  [searchable]="true"
                                  [compareWith]="compareStatus"
                                  [(ngModel)]="vendaPesquisaDTO.vendaStatusLabelDTOs"
                                  [ngModelOptions]="{ standalone: true }"
                                >
                                </ng-select>
                              </div>
                            </div>

                            <div class="col-sm-12 col-12 padding-5">
                              <div class="form-group">
                                <label class="label-select-custom" for="idSelectStatus"
                                  >Filtro de Municípios</label
                                >
                                <ng-select
                                  class="select-custom"
                                  [multiple]="true"
                                  [items]="municipios"
                                  bindLabel="nome"
                                  [closeOnSelect]="true"
                                  [searchable]="true"
                                  [compareWith]="compareMunicipios"
                                  [(ngModel)]="vendaPesquisaDTO.municipioDTOs"
                                  [ngModelOptions]="{ standalone: true }"
                                >
                                </ng-select>
                              </div>
                            </div>
        
                            <div class="col-sm-4 col-6 padding-5">
                              <div class="form-group">
                                <label for="idInputDtaInclusaoInicial"
                                  >Data Inclusão Inicial</label
                                >
                                <input
                                  type="date"
                                  class="form-control"
                                  id="idInputDtaInclusaoInicial"
                                  name="nmInputDtaInclusaoInicial"
                                  ngbTooltip="Busca de pela data de inclusão, data inicial"
                                  [(ngModel)]="vendaPesquisaDTO.dtaInicialPesquisa"
                                  [ngModelOptions]="{ standalone: true }"
                                />
                              </div>
                            </div>
        
                            <div class="col-sm-4 col-6 padding-5">
                              <div class="form-group">
                                <label for="idInputDtaInclusaoFinal"
                                  >Data Inclusão Final</label
                                >
                                <input
                                  type="date"
                                  class="form-control"
                                  id="idInputDtaInclusaoFinal"
                                  name="nmInputDtaInclusaoFinal"
                                  ngbTooltip="Busca de pela data de inclusão, data final"
                                  [(ngModel)]="vendaPesquisaDTO.dtaFinalPesquisa"
                                  [ngModelOptions]="{ standalone: true }"
                                />
                              </div>
                            </div>
        
                            <div class="col-sm-4 col-12 padding-5">
                              <div class="form-group">
                                <label for="idOrigemSales">Origem (PreVenda ou Cupom)</label>
                                <select
                                  class="form-control"
                                  id="idOrigemSales"
                                  [(ngModel)]="vendaPesquisaDTO.origemSales"
                                  [ngModelOptions]="{ standalone: true }"
                                >
                                  <option [ngValue]="null">SELECIONE</option>
                                  <option [ngValue]="'prevenda'">PREVENDA</option>
                                  <option [ngValue]="'cupom'">CUPOM</option>
                                </select>
                              </div>
                            </div>
        
        
                          </div>
                        </ng-template>
                        
                      </div>
                  </div>
              </div>
          </div>



            <br />

            <div class="row">
              <div class="col-sm-2 col-12 padding-5">
                <div class="form-group">
                  <label for="inputId">Id Pré Venda</label>
                  <input
                    type="number"
                    class="form-control"
                    formControlName="id"
                    (keydown.enter)="pesquisaPorId()"
                    ngbTooltip="Id da Pré Venda"
                  />
                </div>
              </div>

              <div class="col-sm-3 col-12 padding-5">
                <div class="form-group">
                  <label for="idCondicaoPagamento">Condição de Pagamento</label>
                  <select
                    class="form-control"
                    #condicaoPagId
                    [ngClass]="{
                      'is-invalid': submitted && f.condicaoPagamento.errors
                    }"
                    [compareWith]="compareCondicaoPagamento"
                    id="idCondicaoPagamento"
                    (change)="alterandoCondicao()"
                    formControlName="condicaoPagamento"
                  >
                    <option [ngValue]="null">SELECIONE</option>
                    <option
                      *ngFor="let cd of condicaoPagamentosVisiveis"
                      [ngValue]="cd"
                    >
                      {{ cd.nome }}
                    </option>
                  </select>
                  <div
                    *ngIf="submitted && f.condicaoPagamento.errors"
                    class="invalid-feedback"
                  >
                    <div *ngIf="f.condicaoPagamento.errors['required']">
                      Selecione uma condição de pagamento
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-sm-3 col-12 padding-5">
                <div class="form-group">
                  <label for="idSelectRepresentante">Representante</label>
                  <select
                    class="form-control"
                    [compareWith]="compareVendedor"
                    (change)="onChangeRepresentante($event)"
                    [ngClass]="{ 'is-invalid': submitted && f.vendedor.errors }"
                    formControlName="vendedor"
                    id="idSelectRepresentante"
                  >
                    <option [ngValue]="null">SELECIONE</option>
                    <option
                      *ngFor="let vd of vendedoresVisiveis"
                      [ngValue]="vd"
                    >
                      {{ vd.nome }}
                    </option>
                  </select>
                  <div
                    *ngIf="submitted && f.vendedor.errors"
                    class="invalid-feedback"
                  >
                    <div *ngIf="f.vendedor.errors['required']">
                      Selecione um vendedor
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-sm-4 col-12 padding-5">
                <div class="form-group">
                  <label for="idEstAlx">Estoque Almoxarifado</label>

                  <select
                    class="form-control"
                    (change)="onChangeAlmoxarifado($event)"
                    ngbTooltip="Selecione o almoxarifado onde será aplicado o pedido"
                    [ngClass]="{
                      'is-invalid': submitted && f.estoqueAlmoxarifadoId.errors
                    }"
                    formControlName="estoqueAlmoxarifadoId"
                    id="idEstAlx"
                  >
                    <option [ngValue]="null">SELECIONE</option>
                    <option
                      *ngFor="let ealxv of estoqueAlmoxarifadoFiltrados"
                      [ngValue]="ealxv.id"
                    >
                      {{ ealxv.nome }}
                    </option>
                  </select>
                  <div
                    *ngIf="submitted && f.estoqueAlmoxarifadoId.errors"
                    class="invalid-feedback"
                  >
                    <div *ngIf="f.estoqueAlmoxarifadoId.errors['required']">
                      Selecione um estoque
                    </div>
                  </div>
                </div>
              </div>

              <div
                class="col-12 padding-5"
                *ngIf="
                  statusForm === 2 &&
                  vendaDTO.vendaStatusAtualDTO !== null &&
                  !isUndefined(vendaDTO.vendaStatusAtualDTO)
                "
              >
                <div class="form-group">
                  <label for="idStatusAtual"
                    >Status Atual -
                    {{
                      vendaDTO.vendaStatusAtualDTO.vendaStatusLabelDTO.sigla
                    }}</label
                  >
                  <span
                    class="form-control span-disable span-status-atual"
                    name="nameStatusAtual"
                    id="idStatusAtual"
                    >Label:
                    {{
                      vendaDTO.vendaStatusAtualDTO.vendaStatusLabelDTO.label
                    }}
                    - Usuário:
                    {{ vendaDTO.vendaStatusAtualDTO.usuarioInclusao }} - Data:
                    {{
                      vendaDTO.vendaStatusAtualDTO.dtaInclusao
                        | amDateFormat
                          : "DD/MM/YYYY
                                        HH:mm:ss"
                    }}
                    - Descrição:
                    {{ vendaDTO.vendaStatusAtualDTO.descricao }}
                  </span>
                </div>
              </div>

              <!--
                        <div class="col-sm-4 col-12 padding-5">
                            <div class="form-group">
                                <label for="idSelectStatus">Status</label>
                                <select class="form-control" formControlName="status" id="idSelectStatus"
                                    [compareWith]="compareStatus">
                                    <option [ngValue]="null">EM CONSTRUÇÃO</option>
                                    <option *ngFor="let st of vendaStatusLabels" [ngValue]="st">{{st.label}}
                                    </option>
                                </select>
                            </div>
                        </div>
                    -->
            </div>

            <div class="div-tabs">
              <ul
                ngbNav
                #nav="ngbNav"
                [(activeId)]="activeNav"
                class="nav-tabs"
              >
                <li [ngbNavItem]="1">
                  <a ngbNavLink>Geral</a>
                  <ng-template ngbNavContent>
                    <br />

                    <div class="col-sm-12 row">
                      <!--
                                        <div class="col-sm-4 col-12 padding-5">
                                            <div class="form-group">
                                                <label for="inputPreVenda">Pré Venda</label>
                                                <input type="text" class="form-control" formControlName="codPreVenda"
                                                    ngbTooltip="Digite o código da Pré Venda">
                                            </div>
                                        </div>
                                    -->

                      <div class="col-sm-6 col-12 padding-5">
                        <div class="form-group">
                          <label for="inputDtaEmissao">Data/hr Inclusão</label>
                          <span
                            class="form-control span-disable"
                            name="nameDtaInclusao"
                            id="idDtaInclusao"
                            >{{
                              vendaDTO.dtaInclusao
                                | amDateFormat : "DD/MM/YYYY HH:mm:ss"
                            }}</span
                          >
                        </div>
                      </div>

                      <div class="col-sm-6 col-12 padding-5">
                        <div class="form-group">
                          <label for="inputDtaEmissao">Usuário Inclusão</label>
                          <span
                            class="form-control span-disable"
                            name="nameUserInclusao"
                            id="idUserInclusao"
                            >{{ vendaDTO.usuarioInclusao }}</span
                          >
                        </div>
                      </div>

                      <hr />

                      <div class="col-sm-6 col-12 padding-5">
                        <div class="form-group">
                          <label for="idDtaCaixa">Data/hr Caixa</label>
                          <span
                            class="form-control span-disable"
                            name="nameDtaCaixa"
                            id="idDtaCaixa"
                            >{{
                              vendaDTO.dtaCaixa
                                | amDateFormat : "DD/MM/YYYY HH:mm:ss"
                            }}</span
                          >
                        </div>
                      </div>

                      <div class="col-sm-6 col-12 padding-5">
                        <div class="form-group">
                          <label for="idUserCaixa">Usuário Caixa</label>
                          <span
                            class="form-control span-disable"
                            name="nameUserCaixa"
                            id="idUserCaixa"
                            >{{ vendaDTO.usuarioCaixa }}</span
                          >
                        </div>
                      </div>

                      <hr />

                      <div class="col-sm-2 col-12 padding-5">
                        <div class="form-group">
                          <label for="idNumPedTOTVS">NUMPED TOTVS</label>
                          <span
                            class="form-control span-disable"
                            name="nameNumPedTotvs"
                            id="idNumPedTOTVS"
                            >{{ vendaDTO.numPedTotvs }}</span
                          >
                        </div>
                      </div>

                      <div class="col-sm-6 col-12 padding-5">
                        <div class="form-group">
                          <label for="idDtaInclusaoTOTVS"
                            >Data/hr Transf TOTVS</label
                          >
                          <span
                            class="form-control span-disable"
                            name="nameDtaInclusaoTotvs"
                            id="idDtaInclusaoTOTVS"
                            >{{
                              vendaDTO.dtaTransfTotvs
                                | amDateFormat : "DD/MM/YYYY HH:mm:ss"
                            }}</span
                          >
                        </div>
                      </div>

                      <div class="col-sm-4 col-12 padding-5">
                        <div class="form-group">
                          <label for="idUserInclusaoTOTVS"
                            >Usuário Inclusão TOTVS</label
                          >
                          <span
                            class="form-control span-disable"
                            name="nameUserInclusaoTOTVS"
                            id="idUserInclusaoTOTVS"
                            >{{ vendaDTO.usuarioTransfTotvs }}</span
                          >
                        </div>
                      </div>

                      <hr />

                      <div class="col-sm-4 col-12 padding-5">
                        <div class="form-group">
                          <label for="idNumNfTotvs"
                            >NUM NOTA NF TOTVS</label
                          >
                          <span
                            class="form-control span-disable"
                            name="nameNumNfTotvs"
                            id="idNumNfTotvs"
                            >{{ vendaDTO.numNotaNfTotvs }}</span
                          >
                        </div>
                      </div>

                      <div class="col-sm-4 col-12 padding-5">
                        <div class="form-group">
                          <label for="idDataNfTotvs"
                            >DATA NOTA NF TOTVS</label
                          >
                          <span
                            class="form-control span-disable"
                            name="nameDataNfTotvs"
                            id="idDataNfTotvs"
                            >{{ vendaDTO.dataNfTotvs }}</span
                          >
                        </div>
                      </div>

                      <div class="col-sm-4 col-12 padding-5">
                        <div class="form-group">
                          <label for="idVlTotalNotaNfTotvs"
                            >VALOR NF TOTVS</label
                          >
                          <span
                            class="form-control span-disable"
                            name="nameVlTotalNotaNfTotvs"
                            id="idVlTotalNotaNfTotvs"
                            >{{ vendaDTO.vlTotalNotaNfTotvs }}</span
                          >
                        </div>
                      </div>

                      <hr />

                      <div class="col-sm-4 col-12 padding-5">
                        <div class="form-group">
                          <label for="inputDtaEmissao">Data Emissão</label>
                          <input
                            type="date"
                            class="form-control"
                            [ngClass]="{
                              'is-invalid': submitted && f.dtaEmissao.errors
                            }"
                            formControlName="dtaEmissao"
                            ngbTooltip="Digite a data de Emissão"
                          />
                          <div
                            *ngIf="submitted && f.dtaEmissao.errors"
                            class="invalid-feedback"
                          >
                            <div *ngIf="f.dtaEmissao.errors['required']">
                              Data de emissão é obrigatoria e não pode estar
                              antes da data atual
                            </div>
                          </div>
                        </div>
                      </div>

                      <div class="col-sm-4 col-12 padding-5">
                        <div class="form-group">
                          <label for="idIptDtaValidade">Data/Hr Entrega</label>
                          <input
                            type="datetime-local"
                            class="form-control"
                            [ngClass]="{
                              'is-invalid': submitted && f.dtaEntrega.errors
                            }"
                            id="idIptDtaValidade"
                            formControlName="dtaEntrega"
                            ngbTooltip="Digite a data/hora de Entrega Estimada"
                          />
                          <div
                            *ngIf="submitted && f.dtaEntrega.errors"
                            class="invalid-feedback"
                          >
                            <div *ngIf="f.dtaEntrega.errors['required']">
                              Data de Entrega é Obrigatoria
                            </div>
                          </div>
                        </div>
                      </div>

                      <div class="col-sm-4 col-12 padding-5">
                        <div class="form-group">
                          <label for="idIptDtaValidade">Data Validade</label>
                          <input
                            type="date"
                            class="form-control"
                            formControlName="dtaValidade"
                            ngbTooltip="Digite a data de Validade"
                          />
                        </div>
                      </div>

                      <div class="col-12 padding-5">
                        <div class="form-group">
                          <label for="nameInputDescricao">Descrição</label>
                          <textarea
                            class="form-control"
                            formControlName="descricao"
                            id="nameInputDescricao"
                          ></textarea>
                        </div>
                      </div>
                    </div>
                  </ng-template>
                </li>
                <li [ngbNavItem]="2">
                  <a ngbNavLink>Cliente</a>
                  <ng-template ngbNavContent>
                    <br />

                    <div *ngIf="flgPesquisandoCliente === 1">
                      <span class="fa fa-refresh fa-spin fa-fw span-pesq"></span
                      ><span class="span-pesq"
                        >Buscando dados do cliente, aguarde...</span
                      >
                    </div>

                    <div class="col-12 padding-5 row">
                      <div class="col-sm-2 col-6 padding-5">
                        <div class="form-group">
                          <label for="input-cgc">Limpar Cliente</label>
                          <div class="d-grid">
                            <button
                              type="button"
                              class="btn btn-outline-dark butao-acao"
                              ngbTooltip="Limpa o cliente selecionado"
                              (click)="onLimpaCliente()"
                            >
                              <span class="fa fa-eraser span-btn2"></span>
                            </button>
                          </div>
                        </div>
                      </div>

                      <div class="col-sm-2 col-6 padding-5">
                        <div class="form-group">
                          <label for="input-cgc">Pesquisa Avançada</label>
                          <div class="d-grid">
                            <button
                              type="button"
                              class="btn btn-outline-dark butao-acao"
                              ngbTooltip="Pesquisa Avançada"
                              (click)="onPesqAvCliente()"
                            >
                              <span class="fa fa-search-plus span-btn2"></span>
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div
                      class="col-12 row margin-padding-0"
                      formGroupName="cliente"
                    >
                      <div class="col-sm-2 col-5 padding-5">
                        <div class="form-group">
                          <label for="idInputCodCli">Cod Cliente</label>
                          <div
                            class="input-group"
                            ngbTooltip="Digite o Codigo do Cliente"
                          >
                            <input
                              type="number"
                              class="form-control"
                              id="idInputCodCli"
                              formControlName="id"
                              (keydown.Tab)="findClienteById()"
                              (keydown.enter)="findClienteById()"
                              [ngClass]="{
                                'is-invalid': submitted && fc['id'].errors
                              }"
                              name="nameInputCodCli"
                              pattern="\d*"
                              inputmode="numeric"
                            />
                            <div class="input-group-append">
                              <button
                                class="btn btn-secondary"
                                (click)="findClienteById()"
                                type="button"
                              >
                                <i class="fa fa-search"></i>
                              </button>
                            </div>
                            <div
                              *ngIf="submitted && fc['id'].errors"
                              class="invalid-feedback"
                            >
                              <div *ngIf="fc['id'].errors['required']">
                                Digite o id do Cliente
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div class="col-sm-3 col-7 padding-5">
                        <div class="form-group">
                          <label for="idInputGCGCli">CGC Cliente</label>
                          <div
                            class="input-group"
                            ngbTooltip="Digite o CGC do Cliente"
                          >
                            <input
                              type="text"
                              class="form-control"
                              id="idInputGCGCli"
                              formControlName="cgc"
                              name="nameInputGCGCli"
                              pattern="\d*"
                              (keydown.Tab)="findClienteByCGC()"
                              (keydown.enter)="findClienteByCGC()"
                              inputmode="numeric"
                              [specialCharacters]="[
                                ' ',
                                '(',
                                ')',
                                '-',
                                '.',
                                '/'
                              ]"
                              [dropSpecialCharacters]="true"
                              [showMaskTyped]="true"
                              mask="00.000.000/0000-00"
                            />
                            <div class="input-group-append">
                              <button
                                class="btn btn-secondary"
                                (click)="findClienteByCGC()"
                                type="button"
                              >
                                <i class="fa fa-search"></i>
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div class="col-12 row margin-padding-0">
                        <div class="col-sm-6 padding-5">
                          <div
                            class="form-group"
                            ngbTooltip="Digite o nome do Cliente"
                          >
                            <label for="typeaheadCliente">Nome Cliente</label>
                            <input
                              id="typeaheadCliente"
                              type="text"
                              class="form-control"
                              [class.is-invalid]="searchFailedCliente"
                              formControlName="nomeTypeahead"
                              [ngbTypeahead]="searchCliente"
                              (selectItem)="typeaHeadSelectCliente($event)"
                              [inputFormatter]="formatterCliente"
                              [resultTemplate]="rt"
                              placeholder="Busca Nome de cliente"
                            />
                            <span
                              class="col-sm-2 col-form-label"
                              *ngIf="searchingCliente"
                              >procurando...</span
                            >
                            <span
                              class="col-sm-12 col-form-label"
                              *ngIf="searchFailedCliente"
                              >Não foi encontrado nada</span
                            >
                          </div>
                        </div>

                        <div class="col-sm-6 padding-5">
                          <div
                            class="form-group"
                            ngbTooltip="Digite o nome fantasia do Cliente"
                          >
                            <label for="typeaheadClienteFantasia"
                              >Fantasia</label
                            >
                            <input
                              id="typeaheadClienteFantasia"
                              type="text"
                              class="form-control"
                              formControlName="fantasiaTypeahead"
                              (selectItem)="typeaHeadSelectCliente($event)"
                              [class.is-invalid]="searchFailedClienteFantasia"
                              [ngbTypeahead]="searchClienteFantasia"
                              [inputFormatter]="formatterFantasia"
                              [resultTemplate]="rtFantasia"
                              placeholder="Busca fantasia de Cliente"
                            />
                            <span
                              class="col-sm-2 col-form-label"
                              *ngIf="searchingClienteFantasia"
                              >procurando...</span
                            >
                            <span
                              class="col-sm-12 col-form-label"
                              *ngIf="searchFailedClienteFantasia"
                              >Não foi encontrado nada</span
                            >
                          </div>
                        </div>
                      </div>
                    </div>

                    <hr
                      *ngIf="
                        vendaDTO.clienteDTO !== null &&
                        !isUndefined(vendaDTO.clienteDTO)
                      "
                    />

                    <div
                      class="col-12 row margin-padding-0"
                      *ngIf="
                        vendaDTO.clienteDTO !== null &&
                        !isUndefined(vendaDTO.clienteDTO)
                      "
                    >
                      <div
                        class="col-sm-3 col-6 padding-5"
                        *ngIf="
                          vendaDTO.clienteDTO.telefone1 !== null &&
                          !isUndefined(vendaDTO.clienteDTO.telefone1)
                        "
                      >
                        <div class="form-group">
                          <label for="id">Fone1</label>
                          <span class="form-control span-disable">{{
                            vendaDTO.clienteDTO.telefone1
                              | mask : "(00) 0000-0000"
                          }}</span>
                        </div>
                      </div>

                      <div
                        class="col-sm-3 col-6 padding-5"
                        *ngIf="
                          vendaDTO.clienteDTO.telefone2 !== null &&
                          !isUndefined(vendaDTO.clienteDTO.telefone2)
                        "
                      >
                        <div class="form-group">
                          <label for="id">Fone2</label>
                          <span class="form-control span-disable">{{
                            vendaDTO.clienteDTO.telefone2
                              | mask : "(00) 0000-0000"
                          }}</span>
                        </div>
                      </div>

                      <div
                        class="col-sm-3 col-6 padding-5"
                        *ngIf="
                          vendaDTO.clienteDTO.celular1 !== null &&
                          !isUndefined(vendaDTO.clienteDTO.celular1) &&
                          vendaDTO.clienteDTO.celular1.length === 10
                        "
                      >
                        <div class="form-group">
                          <label for="id">Cell1</label>
                          <span class="form-control span-disable">{{
                            vendaDTO.clienteDTO.celular1
                              | mask : "(00) 0000-0000"
                          }}</span>
                        </div>
                      </div>

                      <div
                        class="col-sm-3 col-6 padding-5"
                        *ngIf="
                          vendaDTO.clienteDTO.celular1 !== null &&
                          !isUndefined(vendaDTO.clienteDTO.celular1) &&
                          vendaDTO.clienteDTO.celular1.length === 11
                        "
                      >
                        <div class="form-group">
                          <label for="id">Cell1</label>
                          <span class="form-control span-disable">{{
                            vendaDTO.clienteDTO.celular1
                              | mask : "(00) 0.0000-0000"
                          }}</span>
                        </div>
                      </div>

                      <div
                        class="col-sm-3 col-6 padding-5"
                        *ngIf="
                          vendaDTO.clienteDTO.celular2 !== null &&
                          !isUndefined(vendaDTO.clienteDTO.celular2) &&
                          vendaDTO.clienteDTO.celular2.length === 10
                        "
                      >
                        <div class="form-group">
                          <label for="id">Cell2</label>
                          <span class="form-control span-disable">{{
                            vendaDTO.clienteDTO.celular2
                              | mask : "(00) 0000-0000"
                          }}</span>
                        </div>
                      </div>

                      <div
                        class="col-sm-3 col-6 padding-5"
                        *ngIf="
                          vendaDTO.clienteDTO.celular2 !== null &&
                          !isUndefined(vendaDTO.clienteDTO.celular2) &&
                          vendaDTO.clienteDTO.celular2.length === 11
                        "
                      >
                        <div class="form-group">
                          <label for="id">Cell2</label>
                          <span class="form-control span-disable">{{
                            vendaDTO.clienteDTO.celular2
                              | mask : "(00) 0.0000-0000"
                          }}</span>
                        </div>
                      </div>
                    </div>

                    <div
                      class="col-12 padding-5"
                      *ngIf="
                        vendaDTO.clienteDTO !== null &&
                        !isUndefined(vendaDTO.clienteDTO)
                      "
                    >
                      <div class="form-group">
                        <label for="idSelectEndereco"
                          >Endereço de Entrega do Cliente</label
                        >
                        <select
                          class="form-control"
                          [compareWith]="compareEnderecoEntrega"
                          [ngClass]="{
                            'is-invalid': submitted && f.enderecoEntrega.errors
                          }"
                          (change)="enderecoSelecionado()"
                          formControlName="enderecoEntrega"
                        >
                          <option [ngValue]="null" disabled>SELECIONE</option>
                          <option
                            *ngFor="
                              let cedtos of vendaDTO.clienteDTO
                                .clienteEnderecoDTOs
                            "
                            [ngValue]="cedtos"
                          >
                            {{ cedtos.logradouro }},
                            {{ cedtos.numLogradouro }} -
                            {{ cedtos.bairro }}
                            - {{ cedtos.municipioDTO.nome }} -
                            {{ cedtos.municipioDTO.estadoDTO!.nome }}
                          </option>
                        </select>
                        <div
                          *ngIf="submitted && f.enderecoEntrega.errors"
                          class="invalid-feedback"
                        >
                          <div *ngIf="f.enderecoEntrega.errors['required']">
                            Selecione o endereço de entrega
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="col-12 row margin-padding-0">
                      <div
                        class="col-sm-3 col-9 padding-5"
                        *ngIf="
                          vendaDTO.clienteDTO !== null &&
                          !isUndefined(vendaDTO.clienteDTO)
                        "
                      >
                        <div class="form-group">
                          <label for="idInputLogradouro">Logradouro</label>
                          <div class="input-group">
                            <input
                              type="text"
                              class="form-control"
                              id="idInputLogradouro"
                              formControlName="logradouroEntrega"
                            />
                          </div>
                        </div>
                      </div>

                      <div
                        class="col-sm-1 col-3 padding-5"
                        *ngIf="
                          vendaDTO.clienteDTO !== null &&
                          !isUndefined(vendaDTO.clienteDTO)
                        "
                      >
                        <div class="form-group">
                          <label for="idInputNumLogradouro">Num</label>
                          <div class="input-group">
                            <input
                              type="number"
                              class="form-control"
                              id="idInputNumLogradouro"
                              formControlName="numEntrega"
                            />
                          </div>
                        </div>
                      </div>

                      <div
                        class="col-sm-2 col-6 padding-5"
                        *ngIf="
                          vendaDTO.clienteDTO !== null &&
                          !isUndefined(vendaDTO.clienteDTO)
                        "
                      >
                        <div class="form-group">
                          <label for="idInputBairro">Bairro</label>
                          <div class="input-group">
                            <input
                              type="text"
                              class="form-control"
                              id="idInputBairro"
                              formControlName="bairroEntrega"
                            />
                          </div>
                        </div>
                      </div>

                      <div
                        class="col-sm-1 col-6 padding-5"
                        *ngIf="
                          vendaDTO.clienteDTO !== null &&
                          !isUndefined(vendaDTO.clienteDTO)
                        "
                      >
                        <div class="form-group">
                          <label for="idInputCep">Cep</label>
                          <div class="input-group">
                            <input
                              type="text"
                              class="form-control"
                              id="idInputCep"
                              formControlName="cepEntrega"
                            />
                          </div>
                        </div>
                      </div>

                      <div
                        class="col-sm-3 col-6 padding-5"
                        *ngIf="
                          vendaDTO.clienteDTO !== null &&
                          !isUndefined(vendaDTO.clienteDTO)
                        "
                      >
                        <div class="form-group">
                          <label for="idInputCidade">Cidade</label>
                          <div class="input-group">
                            <input
                              type="text"
                              class="form-control"
                              id="idInputCidade"
                              formControlName="municipioEntrega"
                            />
                          </div>
                        </div>
                      </div>

                      <div
                        class="col-sm-2 col-6 padding-5"
                        *ngIf="
                          vendaDTO.clienteDTO !== null &&
                          !isUndefined(vendaDTO.clienteDTO)
                        "
                      >
                        <div class="form-group">
                          <label for="idInputEstado">Estado</label>
                          <div class="input-group">
                            <input
                              type="text"
                              class="form-control"
                              id="idInputEstado"
                              formControlName="estadoEntrega"
                            />
                          </div>
                        </div>
                      </div>

                      <div
                        class="col-sm-2 col-6 padding-5"
                        *ngIf="
                          vendaDTO.clienteDTO !== null &&
                          !isUndefined(vendaDTO.clienteDTO)
                        "
                      >
                        <div class="form-group">
                          <label for="idLatEntrega">Latitude</label>
                          <div class="input-group">
                            <input
                              type="text"
                              class="form-control"
                              id="idLatEntrega"
                              formControlName="latEntrega"
                            />
                          </div>
                        </div>
                      </div>

                      <div
                        class="col-sm-2 col-6 padding-5"
                        *ngIf="
                          vendaDTO.clienteDTO !== null &&
                          !isUndefined(vendaDTO.clienteDTO)
                        "
                      >
                        <div class="form-group">
                          <label for="idLngEntrega">Longitude</label>
                          <div class="input-group">
                            <input
                              type="text"
                              class="form-control"
                              id="idLngEntrega"
                              formControlName="lngEntrega"
                            />
                          </div>
                        </div>
                      </div>
                    </div>

                    <hr
                      *ngIf="
                        vendaDTO.clienteDTO !== null &&
                        !isUndefined(vendaDTO.clienteDTO)
                      "
                    />

                    <div
                      class="col-12 row margin-padding-0"
                      *ngIf="
                        vendaDTO.clienteDTO !== null &&
                        !isUndefined(vendaDTO.clienteDTO)
                      "
                    >
                      <div class="col-sm-3 padding-5">
                        <div class="form-group">
                          <label for="id">Limite</label>
                          <span class="form-control span-disable">{{
                            vendaDTO.clienteDTO
                              .clienteDividaComproLimiteSaldoDTO.limite
                              | number : "1.2-2" : "pt-BR"
                          }}</span>
                        </div>
                      </div>

                      <div
                        class="col-sm-3 col-6 padding-5"
                        ngbTooltip="Pedidos que não estão faturados ainda"
                      >
                        <div class="form-group">
                          <label for="id">Comprometido</label>
                          <span class="form-control span-disable">{{
                            vendaDTO.clienteDTO
                              .clienteDividaComproLimiteSaldoDTO.comprometido
                              | number : "1.2-2" : "pt-BR"
                          }}</span>
                        </div>
                      </div>

                      <div
                        class="col-sm-3 col-6 padding-5"
                        ngbTooltip="Titulos abertos vencidos ou não"
                      >
                        <div class="form-group">
                          <label for="id">Divida</label>
                          <span class="form-control span-disable">{{
                            vendaDTO.clienteDTO
                              .clienteDividaComproLimiteSaldoDTO.divida
                              | number : "1.2-2" : "pt-BR"
                          }}</span>
                        </div>
                      </div>

                      <div
                        class="col-sm-3 padding-5"
                        ngbTooltip="Limite - Comprometido - Divida = Saldo"
                      >
                        <div class="form-group">
                          <label for="id">Saldo</label>
                          <span class="form-control span-disable">{{
                            vendaDTO.clienteDTO
                              .clienteDividaComproLimiteSaldoDTO.saldo
                              | number : "1.2-2" : "pt-BR"
                          }}</span>
                        </div>
                      </div>
                    </div>

                    <hr
                      *ngIf="
                        vendaDTO.clienteDTO !== null &&
                        !isUndefined(vendaDTO.clienteDTO)
                      "
                    />

                    <div
                      class="col-12 row margin-padding-0"
                      *ngIf="
                        vendaDTO.clienteDTO !== null &&
                        !isUndefined(vendaDTO.clienteDTO)
                      "
                    >
                      <div
                        class="col-sm-3 col-6 padding-5"
                        ngbTooltip="Titulos adimplentes"
                      >
                        <div class="form-group">
                          <label for="id">Titulos no prazo</label>
                          <span class="form-control span-disable">{{
                            vendaDTO.clienteDTO.titulosPercAtrasoClienteDTO
                              .qtdTitulosEmDia | number : "1.0" : "pt-BR"
                          }}</span>
                        </div>
                      </div>

                      <div
                        class="col-sm-3 col-6 padding-5"
                        ngbTooltip="Titulos inadimplentes"
                      >
                        <div class="form-group">
                          <label for="id">Titulos em atraso</label>
                          <span class="form-control span-disable">{{
                            vendaDTO.clienteDTO.titulosPercAtrasoClienteDTO
                              .qtdTitulosEmAtraso | number : "1.0" : "pt-BR"
                          }}</span>
                        </div>
                      </div>

                      <div
                        class="col-sm-3 col-6 padding-5"
                        ngbTooltip="Percentual de Titulos inadimplentes"
                      >
                        <div class="form-group">
                          <label for="id">Perc de atraso</label>
                          <span class="form-control span-disable"
                            >{{
                              vendaDTO.clienteDTO.titulosPercAtrasoClienteDTO
                                .perc * 100 | number : "1.2-2" : "pt-BR"
                            }}
                            %</span
                          >
                        </div>
                      </div>

                      <div
                        class="col-sm-3 col-6 padding-5"
                        ngbTooltip="Visualizar Titulos"
                      >
                        <div class="form-group">
                          <label for="id">Visualizar Titulos</label><br />
                          <button
                            type="button"
                            class="btn"
                            (click)="
                              visualizaTitulosCliente(vendaDTO.clienteDTO.id)
                            "
                          >
                            <span
                              class="fa fa-window-maximize span-btn-excluir"
                            ></span>
                          </button>
                        </div>
                      </div>
                    </div>

                    <hr
                      *ngIf="
                        vendaDTO.clienteDTO !== null &&
                        !isUndefined(vendaDTO.clienteDTO)
                      "
                    />

                    <div
                      *ngIf="
                        vendaDTO.clienteDTO !== null &&
                        !isUndefined(vendaDTO.clienteDTO)
                      "
                      class="padding-5"
                    >
                
                        <div ngbAccordion>
                          <div ngbAccordionItem [collapsed]="true">
                              <h2 ngbAccordionHeader>
                                  <button ngbAccordionButton>DADOS DO CLIENTE</button>
                              </h2>
            
                              <div ngbAccordionCollapse>
                                  <div ngbAccordionBody>
                                    <ng-template >
                                      <div class="row">
                                        <div class="col-sm-3 margin-padding-0">
                                          <div class="form-group">
                                            <label for="id">Label Status</label>
                                            <span class="form-control span-disable">
                                              {{
                                                vendaDTO.clienteDTO.clienteStatusDTO
                                                  .clienteStatusLabelDTO!.label
                                              }}
                                            </span>
                                          </div>
                                        </div>
          
                                        <div class="col-sm-9 margin-padding-0">
                                          <div class="form-group">
                                            <label for="id">Descrição Status</label>
                                            <span class="form-control span-disable">
                                              {{
                                                vendaDTO.clienteDTO.clienteStatusDTO
                                                  .clienteStatusLabelDTO!.descricao
                                              }}</span
                                            >
                                          </div>
                                        </div>
          
                                        <div class="col-sm-6 margin-padding-0">
                                          <div class="form-group">
                                            <label for="idDtaInclusaoStatusLabel"
                                              >Data Inclusão</label
                                            >
                                            <span
                                              class="form-control span-disable"
                                              name="nameDtaInclusaoStatusLabel"
                                              id="idDtaInclusaoStatusLabel"
                                              >{{
                                                vendaDTO.clienteDTO.clienteStatusDTO
                                                  .dtaInclusao
                                                  | amDateFormat : "DD/MM/YYYY HH:mm:ss"
                                              }}</span
                                            >
                                          </div>
                                        </div>
          
                                        <div class="col-sm-6 margin-padding-0">
                                          <div class="form-group">
                                            <label for="idUsuarioInclusaoStatusLabel"
                                              >Usuário Inclusão</label
                                            >
                                            <span class="form-control span-disable">{{
                                              vendaDTO.clienteDTO.clienteStatusDTO
                                                .usuarioInclusao
                                            }}</span>
                                          </div>
                                        </div>
          
                                        <div class="col-sm-6 margin-padding-0">
                                          <div class="form-group">
                                            <label for="idBloqCompraStatusLabel"
                                              >Bloqueado para Venda?</label
                                            >
                                            <span
                                              class="form-control span-disable"
                                              name="nameBloqCompraStatusLabel"
                                              id="idBloqCompraStatusLabel"
                                              >{{
                                                vendaDTO.clienteDTO.clienteStatusDTO
                                                  .clienteStatusLabelDTO!.isVendaBloqueada
                                                  ? "Sim"
                                                  : "Não"
                                              }}</span
                                            >
                                          </div>
                                        </div>
                                        <div class="col-sm-12 margin-padding-0">
                                          <div class="form-group">
                                            <label for="idTableCondicoesCliente"
                                              >Condições do Cliente</label
                                            >
                                            <table class="table table-bordered">
                                              <thead>
                                                <tr>
                                                  <th>Id</th>
                                                  <th>Condição</th>
                                                </tr>
                                              </thead>
                                              <tbody>
                                                <tr
                                                  *ngFor="
                                                    let clicond of vendaDTO.clienteDTO
                                                      .condicaoPagamentoDTOs
                                                  "
                                                >
                                                  <td class="align-left">
                                                    {{ clicond.id }}
                                                  </td>
                                                  <td class="align-left">
                                                    {{ clicond.nome }}
                                                  </td>
                                                </tr>
                                              </tbody>
                                            </table>
                                          </div>
                                        </div>
          
                                        <div class="col-sm-12 margin-padding-0">
                                          <div class="form-group">
                                            <label for="idTableCondicoesCliente"
                                              >Representantes do Cliente</label
                                            >
                                            <table class="table table-bordered">
                                              <thead>
                                                <tr>
                                                  <th>Id</th>
                                                  <th>Nome</th>
                                                </tr>
                                              </thead>
                                              <tbody>
                                                <tr
                                                  *ngFor="
                                                    let vend of vendaDTO.clienteDTO
                                                      .clienteVendedorDTOs
                                                  "
                                                >
                                                  <td class="align-left">
                                                    {{ vend.funcionarioDTO!.id }}
                                                  </td>
                                                  <td class="align-left">
                                                    {{ vend.funcionarioDTO!.nome }}
                                                  </td>
                                                </tr>
                                              </tbody>
                                            </table>
                                          </div>
                                        </div>
                                      </div>
                                    </ng-template>
                                    
                                  </div>
                              </div>
                          </div>
                      </div>


              
                    </div>
                  </ng-template>
                </li>
                <li [ngbNavItem]="3">
                  <a ngbNavLink>Itens</a>
                  <ng-template ngbNavContent>
                    <br />
                    <div *ngIf="flgPesquisandoItem === 1">
                      <span class="fa fa-refresh fa-spin fa-fw span-pesq"></span
                      ><span class="span-pesq"
                        >Buscando dados adicionais do item, aguarde...</span
                      >
                    </div>

                    <div class="col-12 padding-5 row">
                      <div class="col-sm-2 col-6 padding-5">
                        <div class="form-group">
                          <label for="input-cgc">Limpar Item</label>
                          <div class="d-grid">
                            <button
                              type="button"
                              class="btn btn-outline-dark butao-acao"
                              ngbTooltip="Limpa o item selecionado"
                              (click)="onLimpaItem()"
                            >
                              <span class="fa fa-eraser span-btn2"></span>
                            </button>
                          </div>
                        </div>
                      </div>

                      <div class="col-sm-2 col-6 padding-5">
                        <div class="form-group">
                          <label for="input-cgc">Pesquisa Avançada</label>
                          <div class="d-grid">
                            <button
                              type="button"
                              class="btn btn-outline-dark butao-acao"
                              ngbTooltip="Pesquisa Avançada"
                              (click)="onPesqAvItem()"
                            >
                              <span class="fa fa-search-plus span-btn2"></span>
                            </button>
                          </div>
                        </div>
                      </div>

                      <div class="col-sm-2 col-12 padding-5">
                        <div class="form-group">
                          <label for="id">Top Itens Cliente</label>
                          <div class="d-grid">
                            <button
                              type="button"
                              class="btn btn-outline-dark butao-acao"
                              (click)="buscaTopItensCliente2()"
                            >
                              <span
                                class="fa span-btn2"
                                [ngClass]="
                                  flgPesquisandoTopItens === 1
                                    ? 'fa-refresh fa-spin fa-fw'
                                    : 'fa-window-maximize span-btn-excluir'
                                "
                              ></span>
                              <span>{{
                                flgPesquisandoTopItens === 1
                                  ? " Consultando..."
                                  : ""
                              }}</span>
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div
                      class="col-12 row margin-padding-0"
                      formGroupName="item"
                    >
                      <div class="col-sm-2 col-6 padding-5">
                        <div class="form-group">
                          <label for="idInputCodItemId">Cod Item</label>
                          <div
                            class="input-group"
                            ngbTooltip="Digite o Codigo do Item"
                          >
                            <input
                              type="number"
                              class="form-control"
                              id="idInputCodItemId"
                              formControlName="id"
                              (keydown.Tab)="findItemById($event)"
                              (keydown.enter)="findItemById($event)"
                              name="nameInputCodItem"
                              pattern="\d*"
                              inputmode="numeric"
                            />
                            <div class="input-group-append">
                              <button
                                class="btn btn-secondary"
                                (click)="findItemById($event)"
                                type="button"
                              >
                                <i class="fa fa-search"></i>
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div class="col-sm-2 col-6 padding-5">
                        <div class="form-group">
                          <label for="idInputCodItemAux">Cod Aux</label>
                          <div
                            class="input-group"
                            ngbTooltip="Digite o Codigo do Item Auxiliar Emsys"
                          >
                            <input
                              type="number"
                              class="form-control"
                              id="idInputCodItemAux"
                              formControlName="idAux"
                              (keydown.Tab)="findItemByIdAux($event)"
                              (keydown.enter)="findItemByIdAux($event)"
                              name="nameInputCodItemAux"
                              pattern="\d*"
                              inputmode="numeric"
                            />
                            <div class="input-group-append">
                              <button
                                class="btn btn-secondary"
                                (click)="findItemByIdAux($event)"
                                type="button"
                              >
                                <i class="fa fa-search"></i>
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div class="col-sm-8 col-12 padding-5">
                        <div
                          class="form-group"
                          ngbTooltip="Digite o nome do Item"
                        >
                          <label for="typeaheadCliente">Nome Item</label>
                          <input
                            id="idTypeaheadItem"
                            type="text"
                            class="form-control"
                            [class.is-invalid]="searchFailedItemNome"
                            formControlName="nomeTypeahead"
                            [ngbTypeahead]="searchItemNome"
                            (selectItem)="typeaHeadSelectItem($event)"
                            [inputFormatter]="formatterItem"
                            [resultTemplate]="rt"
                            placeholder="Busca Nome de item"
                          />
                          <span
                            class="col-sm-2 col-form-label"
                            *ngIf="searchingItemNome"
                            >procurando...</span
                          >
                          <span
                            class="col-sm-12 col-form-label"
                            *ngIf="searchFailedItemNome"
                            >Não foi encontrado nada</span
                          >
                        </div>
                      </div>

                      <hr *ngIf="isItemSelecionado()" />
                      <div
                        *ngIf="isItemSelecionado()"
                        class="col-12 row margin-padding-0"
                      >
                        <div
                          class="col-12"
                          *ngIf="flgPesquisandoEstoqueItem === 1"
                        >
                          <span
                            class="fa fa-refresh fa-spin fa-fw span-pesq"
                          ></span
                          ><span class="span-pesq"
                            >Buscando estoque do item, aguarde...</span
                          >
                        </div>

                        <div class="col-sm-3 col-12 padding-5">
                          <div class="form-group">
                            <label for="idSpanItemBloqVenda"
                              >Venda Bloqueada</label
                            >
                            <div class="input-group">
                              <span
                                class="form-control span-disable"
                                name="nmSpanItemBloqVenda"
                                id="idSpanItemBloqVenda"
                                >{{
                                  itemSelecionado.vendaBloqueada ? "Sim" : "Não"
                                }}</span
                              >
                            </div>
                          </div>
                        </div>

                        <div class="col-sm-3 col-4 padding-5">
                          <div class="form-group">
                            <label for="idInputCodCli">Estoque</label>
                            <div class="input-group">
                              <span
                                class="form-control span-disable"
                                name="idSaldoEstoque"
                                id="idSaldoEstoque"
                                >{{
                                  itemSelecionado.qtdSaldo
                                    | number : "1.0-0" : "pt-BR"
                                }}</span
                              >
                            </div>
                          </div>
                        </div>

                        <div class="col-sm-3 col-4 padding-5">
                          <div class="form-group">
                            <label for="idInputCodCli">Compromet</label>
                            <div class="input-group">
                              <span
                                class="form-control span-disable"
                                name="idSaldoEstoque"
                                id="idSaldoEstoque"
                                >{{
                                  itemSelecionado.qtdComprometido
                                    | number : "1.0-0" : "pt-BR"
                                }}</span
                              >
                            </div>
                          </div>
                        </div>

                        <div class="col-sm-3 col-4 padding-5">
                          <div class="form-group">
                            <label for="idInputCodCli">Disponivel</label>
                            <div class="input-group">
                              <span
                                class="form-control span-disable"
                                name="idSaldoEstoque"
                                id="idSaldoEstoque"
                                >{{
                                  itemSelecionado.qtdDisponivel
                                    | number : "1.0-0" : "pt-BR"
                                }}</span
                              >
                            </div>
                          </div>
                        </div>

                        <br />
                        <div
                          class="col-12"
                          style="margin-top: 20px; margin-bottom: 20px"
                        >
                          <ngb-carousel
                            *ngIf="
                              itemSelecionado !== null &&
                              !isUndefined(itemSelecionado) &&
                              itemSelecionado.itemImagemDTOs !== null &&
                              !isUndefined(itemSelecionado.itemImagemDTOs) &&
                              isArray(itemSelecionado.itemImagemDTOs) &&
                              itemSelecionado.itemImagemDTOs.length > 0
                            "
                          >
                            <ng-template
                              ngbSlide
                              *ngFor="
                                let itemImg of itemSelecionado.itemImagemDTOs
                              "
                            >
                              <div class="picsum-img-wrapper">
                                <img
                                  [src]="itemImg.srcImg"
                                  class="rounded mx-auto d-block img-max-lenght"
                                  [alt]="itemImg.fileName"
                                  [title]="itemImg.fileName"
                                />
                              </div>
                            </ng-template>
                          </ngb-carousel>
                        </div>
                        <br />

                        <div class="col-12">
                          <hr />
                        </div>

                        <span
                          *ngIf="itemSelecionado.itemUnidadeDTOs.length === 0"
                          >Não existe agrupamento/preço configurado</span
                        >
                        <br
                          *ngIf="itemSelecionado.itemUnidadeDTOs.length === 0"
                        />
                        <br
                          *ngIf="itemSelecionado.itemUnidadeDTOs.length === 0"
                        />
                        <span *ngIf="itemSelecionado.itemUnidadeDTOs.length > 0"
                          >Preços</span
                        >
                        <div
                          class="col-12 padding-5"
                          *ngIf="itemSelecionado.itemUnidadeDTOs.length > 0"
                        >
                          <table class="table table-bordered table-venda">
                            <thead>
                              <tr>
                                <th>Agrupamento</th>
                                <th>Estoque</th>
                                <th>Valor</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr
                                *ngFor="
                                  let und of itemSelecionado.itemUnidadeDTOs
                                "
                              >
                                <td>{{ und.nome }}</td>
                                <td>
                                  {{
                                    getEstoquePorAgr(und)
                                      | number : "1.0-0" : "pt-BR"
                                  }}
                                </td>
                                <td>
                                  {{
                                    getValorPorAgr(und)
                                      | number : "1.2-2" : "pt-BR"
                                  }}
                                </td>
                              </tr>
                            </tbody>
                          </table>
                        </div>

                        <div class="col-12">
                          <hr />
                        </div>

                        <span
                          *ngIf="
                            itemSelecionado.itemAlxDescontoDTOs.length === 0
                          "
                          >Não existe desconto configurado</span
                        >
                        <br
                          *ngIf="
                            itemSelecionado.itemAlxDescontoDTOs.length === 0
                          "
                        />
                        <br
                          *ngIf="
                            itemSelecionado.itemAlxDescontoDTOs.length === 0
                          "
                        />
                        <span
                          *ngIf="itemSelecionado.itemAlxDescontoDTOs.length > 0"
                          >Descontos</span
                        >
                        <div
                          class="col-12 padding-5"
                          *ngIf="itemSelecionado.itemAlxDescontoDTOs.length > 0"
                        >
                          <table class="table table-bordered table-venda">
                            <thead>
                              <tr>
                                <th>Agrupamento</th>
                                <th>Qtd</th>
                                <th>Perc</th>
                                <th>Vlr</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr
                                *ngFor="
                                  let desc of itemSelecionado.itemAlxDescontoDTOs
                                "
                              >
                                <td>{{ desc.itemUnidadeDTO.nome }}</td>
                                <td>{{ desc.qtd | number : "1.0" }}</td>
                                <td>
                                  {{
                                    desc.percDesc | number : "1.2-2" : "pt-BR"
                                  }}
                                </td>
                                <td>
                                  {{
                                    getValorComDesconto(desc.percDesc)
                                      | number : "1.2-2" : "pt-BR"
                                  }}
                                </td>
                              </tr>
                            </tbody>
                          </table>
                        </div>

                        <div class="col-12">
                          <hr />
                        </div>

                        <span
                          *ngIf="
                            itemSelecionado.itemAlxVendDescontoDTOs.length === 0
                          "
                          >Não existe desconto de representante
                          configurado</span
                        >
                        <br
                          *ngIf="
                            itemSelecionado.itemAlxVendDescontoDTOs.length === 0
                          "
                        />
                        <br
                          *ngIf="
                            itemSelecionado.itemAlxVendDescontoDTOs.length === 0
                          "
                        />
                        <span
                          *ngIf="
                            itemSelecionado.itemAlxVendDescontoDTOs.length > 0
                          "
                          >Descontos de representante</span
                        >
                        <div
                          class="col-12 padding-5"
                          *ngIf="
                            itemSelecionado.itemAlxVendDescontoDTOs.length > 0
                          "
                        >
                          <table class="table table-bordered table-venda">
                            <thead>
                              <tr>
                                <th>Agrupamento</th>
                                <th>Qtd</th>
                                <th>Perc</th>
                                <th>Vlr</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr
                                *ngFor="
                                  let desc of itemSelecionado.itemAlxVendDescontoDTOs
                                "
                              >
                                <td>{{ desc.itemUnidadeDTO.nome }}</td>
                                <td>{{ desc.qtd | number : "1.0" }}</td>
                                <td>
                                  {{
                                    desc.percDesc | number : "1.2-2" : "pt-BR"
                                  }}
                                </td>
                                <td>
                                  {{
                                    getValorComDesconto(desc.percDesc)
                                      | number : "1.2-2" : "pt-BR"
                                  }}
                                </td>
                              </tr>
                            </tbody>
                          </table>
                        </div>

                        <div class="col-12">
                          <hr />
                        </div>

                        <div class="col-sm-12 col-12 padding-5">
                          <div class="form-group">
                            <label for="idInputCodCli">Agrupamento</label>
                            <div class="input-group">
                              <select
                                class="form-control"
                                name="nmAgItemSelecionado"
                                [ngClass]="{
                                  'is-invalid':
                                    submittedItem && fi['agrupamento'].errors
                                }"
                                id="idAgItemSelecionado"
                                formControlName="agrupamento"
                              >
                                <option [ngValue]="null" disabled>
                                  Selecione
                                </option>
                                <option
                                  *ngFor="
                                    let un of itemSelecionado.itemUnidadeDTOs
                                  "
                                  [ngValue]="un"
                                >
                                  {{ un.nome }}
                                </option>
                              </select>
                              <div
                                *ngIf="
                                  submittedItem && fi['agrupamento'].errors
                                "
                                class="invalid-feedback"
                              >
                                <div
                                  *ngIf="fi['agrupamento'].errors['required']"
                                >
                                  O agrupamento precisa ser selecionado
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>

                        <div class="col-sm-1 col-6 padding-5">
                          <div class="form-group">
                            <label for="idInputCodCli">Qtd</label>
                            <div class="input-group">
                              <input
                                type="number"
                                class="form-control"
                                id="idItemQtd"
                                #qtdItemInput
                                [ngClass]="{
                                  'is-invalid':
                                    submittedItem && fi['qtd'].errors
                                }"
                                ngbTooltip="Quantidade do item para venda segundo seu agrupamento"
                                inputmode="numeric"
                                formControlName="qtd"
                              />
                              <div
                                *ngIf="submittedItem && fi['qtd'].errors"
                                class="invalid-feedback"
                              >
                                <div *ngIf="fi['qtd'].errors['required']">
                                  Qtd precisa ser digitada
                                </div>
                                <div *ngIf="fi['qtd'].errors['min']">
                                  Qtd deve ser maior que 0
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>

                        <div class="col-sm-2 col-6 padding-5">
                          <div class="form-group">
                            <label for="idInputCodCli">Total Vlr Calc</label>
                            <div class="input-group">
                              <span
                                class="form-control span-disable"
                                name="idSaldoEstoque"
                                (click)="setaVlrTotal('vlrTotalCalc')"
                                (keydown.enter)="setaVlrTotal('vlrTotalCalc')"
                                tabindex="{0}"
                                ngbTooltip="Campo calculado automaticamente"
                                id="idSaldoEstoque"
                                >{{
                                  getVlrTotalItem() | number : "1.2-2" : "pt-BR"
                                }}</span
                              >
                            </div>
                          </div>
                        </div>

                        <div class="col-sm-1 col-6 padding-5">
                          <div class="form-group">
                            <label for="idInputCodCli">Perc Desc</label>
                            <div class="input-group">
                              <input
                                type="number"
                                class="form-control"
                                [ngClass]="{
                                  'is-invalid':
                                    submittedItem && fi['perc'].errors
                                }"
                                ngbTooltip="Percentual de desconto"
                                id="idItemPerc"
                                inputmode="decimal"
                                formControlName="perc"
                              />
                              <div
                                *ngIf="submittedItem && fi['perc'].errors"
                                class="invalid-feedback"
                              >
                                <div *ngIf="fi['perc'].errors['min']">
                                  Perc deve ser maior que 0 ou vazio
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>

                        <div class="col-sm-2 col-6 padding-5">
                          <div class="form-group">
                            <label for="idInputCodCli">Total Vlr Perc</label>
                            <div class="input-group">
                              <span
                                class="form-control span-disable"
                                name="nameSapnPercItem"
                                (click)="setaVlrTotal('vlrTotalPerc')"
                                (keydown.enter)="setaVlrTotal('vlrTotalPerc')"
                                tabindex="{1}"
                                ngbTooltip="Campo calculado automaticamente"
                                id="idSapnPercItem"
                                >{{
                                  getVlrTotalPerc() | number : "1.2-2" : "pt-BR"
                                }}</span
                              >
                            </div>
                          </div>
                        </div>

                        <div class="col-sm-1 col-6 padding-5">
                          <div class="form-group">
                            <label for="idVlrAg">Vlr Ag</label>
                            <div class="input-group">
                              <input
                                type="number"
                                class="form-control"
                                ngbTooltip="Valor do Agrupamento"
                                id="idVlrAg"
                                inputmode="decimal"
                                formControlName="vlrAg"
                              />
                            </div>
                          </div>
                        </div>

                        <div class="col-sm-2 col-6 padding-5">
                          <div class="form-group">
                            <label for="id">Total Vlr Ag</label>
                            <div class="input-group">
                              <span
                                class="form-control span-disable"
                                (click)="setaVlrTotal('vlrAg')"
                                (keydown.enter)="setaVlrTotal('vlrAg')"
                                tabindex="{3}"
                                id="idSapnPercItem"
                                >{{
                                  getVlrTotalAg() | number : "1.2-2" : "pt-BR"
                                }}</span
                              >
                            </div>
                          </div>
                        </div>

                        <div class="col-sm-3 col-12 padding-5">
                          <div class="form-group">
                            <label for="idInputCodCli">Valor Total</label>
                            <div class="input-group">
                              <input
                                type="number"
                                [ngClass]="{
                                  'is-invalid':
                                    submittedItem && fi['vlr'].errors
                                }"
                                class="form-control"
                                id="idItemVlrLanc"
                                formControlName="vlr"
                                ngbTooltip="Campo de lançamento livre do total do preço do item"
                                inputmode="decimal"
                                (keydown.enter)="onAddItem($event)"
                              />
                              <div
                                *ngIf="submittedItem && fi['vlr'].errors"
                                class="invalid-feedback"
                              >
                                <div *ngIf="fi['vlr'].errors['required']">
                                  Valor precisa ser digitado
                                </div>
                                <div *ngIf="fi['vlr'].errors['min']">
                                  Valor deve ser maior que 0
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>

                        <div class="col-12 padding-5 row">
                          <div class="col-sm-3 col-6 padding-5 d-grid">
                            <button
                              type="button"
                              class="btn btn-block btn-primary butao-acao"
                              (click)="onAddItem($event)"
                            >
                              <span class="fa fa-plus span-btn2"></span>
                              Adicionar Item
                            </button>
                          </div>

                          <div class="col-sm-3 col-6 padding-5 d-grid">
                            <button
                              type="button"
                              class="btn btn-block btn-outline-dark butao-acao"
                              (click)="onLimpaItemCampos()"
                            >
                              <span class="fa fa-eraser span-btn2"></span> Limpa
                              Campos
                            </button>
                          </div>
                        </div>
                      </div>

                      <div
                        *ngIf="vendaDTO.vendaItemDTOs.length > 0"
                        class="col-12 margin-padding-0 horizontal-scroll"
                      >
                        <hr />
                        <br />

                        <ngx-datatable
                          class="material striped"
                          [scrollbarH]="true"
                          appResizeWatcher
                          [rows]="vendaDTO.vendaItemDTOs"
                          [columnMode]="ColumnMode.standard"
                          [headerHeight]="35"
                          [footerHeight]="50"
                          rowHeight="auto"
                          [limit]="50"
                          [selected]="selectedItem"
                          [selectionType]="selectionTypeSingle"
                        >
                          <ngx-datatable-column name="RM" [width]="40">
                            <ng-template
                              let-row="row"
                              ngx-datatable-cell-template
                            >
                              <button
                                type="button"
                                class="btn btn-danger botao-acao-item"
                                (click)="removeItemVenda(row)"
                              >
                                <span
                                  class="fa fa-trash span-btn-excluir"
                                ></span>
                              </button>
                            </ng-template>
                          </ngx-datatable-column>

                          <ngx-datatable-column
                            name="QTD"
                            prop="qtd"
                            [width]="40"
                          >
                          </ngx-datatable-column>

                          <ngx-datatable-column
                            name="ITEM NOME"
                            prop="itemDTO.nome"
                            [width]="190"
                          >
                          </ngx-datatable-column>

                          <ngx-datatable-column
                            name="AGRUPAMENTO"
                            prop="itemUnidadeDTO.nome"
                            [width]="110"
                          >
                          </ngx-datatable-column>

                          <ngx-datatable-column
                            name="ITEM ID"
                            prop="itemDTO.id"
                            [width]="60"
                          >
                          </ngx-datatable-column>

                          <ngx-datatable-column
                            name="ESTOQUE ATUAL"
                            [width]="100"
                          >
                            <ng-template
                              let-row="row"
                              let-value="value"
                              ngx-datatable-cell-template
                            >
                              {{
                                qtdEstoqueAtualTable(row)
                                  | number : "1.2-2" : "pt-BR"
                              }}
                            </ng-template>
                          </ngx-datatable-column>

                          <ngx-datatable-column
                            name="PERC DESC"
                            prop="percDesconto"
                            [width]="70"
                          >
                            <ng-template
                              let-value="value"
                              ngx-datatable-cell-template
                            >
                              {{ value | number : "1.2-2" : "pt-BR" }}
                            </ng-template>
                          </ngx-datatable-column>

                          <ngx-datatable-column
                            name="PREÇO SIST"
                            prop="vlrUnitarioOrig"
                            [width]="70"
                          >
                            <ng-template
                              let-value="value"
                              ngx-datatable-cell-template
                            >
                              {{ value | number : "1.2-2" : "pt-BR" }}
                            </ng-template>
                          </ngx-datatable-column>

                          <ngx-datatable-column
                            name="VALOR UN"
                            prop="vlrUnitario"
                            [width]="70"
                          >
                            <ng-template
                              let-value="value"
                              ngx-datatable-cell-template
                            >
                              {{ value | number : "1.2-3" : "pt-BR" }}
                            </ng-template>
                          </ngx-datatable-column>

                          <ngx-datatable-column
                            name="VALOR AUT"
                            prop="vlrOrig"
                            [width]="70"
                          >
                            <ng-template
                              let-value="value"
                              ngx-datatable-cell-template
                            >
                              {{ value | number : "1.2-2" : "pt-BR" }}
                            </ng-template>
                          </ngx-datatable-column>

                          <ngx-datatable-column
                            name="VALOR DESC"
                            prop="vlrDesconto"
                            [width]="80"
                          >
                            <ng-template
                              let-value="value"
                              ngx-datatable-cell-template
                            >
                              {{ value | number : "1.2-2" : "pt-BR" }}
                            </ng-template>
                          </ngx-datatable-column>

                          <ngx-datatable-column name="VALOR AGRUP" [width]="90">
                            <ng-template
                              let-row="row"
                              let-value="value"
                              ngx-datatable-cell-template
                            >
                              {{
                                getValorAgItemRow(row)
                                  | number : "1.2-3" : "pt-BR"
                              }}
                            </ng-template>
                          </ngx-datatable-column>

                          <ngx-datatable-column
                            name="VALOR"
                            prop="vlr"
                            [width]="90"
                          >
                            <ng-template
                              let-value="value"
                              ngx-datatable-cell-template
                            >
                              {{ value | number : "1.2-2" : "pt-BR" }}
                            </ng-template>
                          </ngx-datatable-column>
                        </ngx-datatable>
                      </div>
                    </div>
                  </ng-template>
                </li>

                <!--
                            <ngb-tab title="Titulos" id="tab-titulos" *ngIf="isTitulosExists()">
                                <ng-template ngbTabContent>
                                -->
                <li [ngbNavItem]="4" [disabled]="!isTitulosExists()">
                  <a ngbNavLink>Títulos</a>
                  <ng-template ngbNavContent>
                    <br />
                    <br />
                    <ngx-datatable
                      class="material striped"
                      [scrollbarH]="true"
                      appResizeWatcher
                      [rows]="[vendaDTO.tituloReceberDTO]"
                      [columnMode]="ColumnMode.standard"
                      [headerHeight]="35"
                      [footerHeight]="50"
                      [sorts]="[{ prop: 'id', dir: 'desc' }]"
                      rowHeight="auto"
                      [selectionType]="selectionTypeSingle"
                      [limit]="200"
                    >
                      <ngx-datatable-column
                        name="TITULO ID"
                        prop="id"
                        [width]="140"
                      >
                      </ngx-datatable-column>

                      <ngx-datatable-column
                        name="STATUS"
                        prop="indStatus"
                        [width]="130"
                      >
                        <ng-template
                          let-value="value"
                          ngx-datatable-cell-template
                        >
                          {{ getStatusTituloReceber(value) }}
                        </ng-template>
                      </ngx-datatable-column>

                      <ngx-datatable-column
                        name="TIPO"
                        prop="tituloTipoDTO.nome"
                        [width]="130"
                      >
                      </ngx-datatable-column>

                      <ngx-datatable-column
                        name="BANCO"
                        prop="bancoFebrabanDTO.desBanco"
                        [width]="320"
                      ></ngx-datatable-column>

                      <ngx-datatable-column
                        name="EMISSÃO"
                        prop="dtaEmissao"
                        [width]="130"
                      >
                        <ng-template
                          let-value="value"
                          ngx-datatable-cell-template
                        >
                          {{ value | amDateFormat : "DD/MM/YYYY" }}
                        </ng-template>
                      </ngx-datatable-column>

                      <ngx-datatable-column
                        name="VENCIMENTO"
                        prop="dtaVencimento"
                        [width]="130"
                      >
                        <ng-template
                          let-value="value"
                          ngx-datatable-cell-template
                        >
                          {{ value | amDateFormat : "DD/MM/YYYY" }}
                        </ng-template>
                      </ngx-datatable-column>

                      <ngx-datatable-column
                        name="LIQUIDAÇÃO"
                        prop="dtaLiquidacao"
                        [width]="130"
                      >
                        <ng-template
                          let-value="value"
                          ngx-datatable-cell-template
                        >
                          {{ value | amDateFormat : "DD/MM/YYYY" }}
                        </ng-template>
                      </ngx-datatable-column>

                      <ngx-datatable-column
                        name="VALOR TOTAL"
                        prop="vlrTotal"
                        [width]="170"
                      >
                        <ng-template
                          let-value="value"
                          ngx-datatable-cell-template
                        >
                          {{ value | number : "1.2-2" : "pt-BR" }}
                        </ng-template>
                      </ngx-datatable-column>
                    </ngx-datatable>
                  </ng-template>
                </li>

                <li [ngbNavItem]="5">
                  <a ngbNavLink>Historico Status</a>
                  <ng-template ngbNavContent>
                    <br />
                    <br />
                    <ngx-datatable
                      class="material striped"
                      [scrollbarH]="true"
                      appResizeWatcher
                      [rows]="vendaDTO.vendaStatusDTOs"
                      [columnMode]="ColumnMode.standard"
                      [headerHeight]="35"
                      [footerHeight]="50"
                      [sorts]="[{ prop: 'id', dir: 'desc' }]"
                      [selected]="selectedHistoricoStatus"
                      rowHeight="auto"
                      [selectionType]="selectionTypeSingle"
                      [limit]="200"
                    >
                      <ngx-datatable-column
                        name="ID"
                        prop="id"
                        [width]="100"
                      ></ngx-datatable-column>
                      <ngx-datatable-column
                        name="LABEL"
                        prop="vendaStatusLabelDTO.label"
                        [width]="170"
                      >
                      </ngx-datatable-column>
                      <ngx-datatable-column
                        name="DATA INCLUSÃO"
                        prop="dtaInclusao"
                        [width]="170"
                      >
                        <ng-template
                          let-value="value"
                          ngx-datatable-cell-template
                        >
                          {{ value | amDateFormat : "DD/MM/YYYY HH:mm:ss" }}
                        </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column
                        name="USUÁRIO INCLUSÃO"
                        prop="usuarioInclusao"
                        [width]="140"
                      >
                      </ngx-datatable-column>
                      <ngx-datatable-column
                        name="MOTIVO"
                        prop="vendaStatusMotivoDTO.nome"
                        [width]="270"
                      >
                      </ngx-datatable-column>
                      <ngx-datatable-column
                        name="DESCRIÇÃO"
                        prop="descricao"
                        [width]="600"
                      >
                      </ngx-datatable-column>
                    </ngx-datatable>
                  </ng-template>
                </li>
              </ul>
              <div [ngbNavOutlet]="nav" class="mt-2"></div>
            </div>
            <div class="div-totals">
              <div class="col-12 padding-5 text-center">
                <h5>Resumo da Pré-Venda</h5>
              </div>
              <br />
              <div class="col-12 padding-5 row">
                <div class="col-sm-4 col-6 padding-5">
                  <div class="form-group">
                    <label for="idVlrProdutosOrig">Vlr Produtos Auto</label>
                    <div class="input-group">
                      <span
                        class="form-control span-disable"
                        name="nameSpanVlrProdutosOrig"
                        ngbTooltip="Campo calculado automaticamente, representa o somatorio dos valores originais sem desconto ou acrescimo dos produtos"
                        id="idVlrProdutosOrig"
                        >{{
                          getVlrTotalProdutosOrig() | number : "1.2-2" : "pt-BR"
                        }}</span
                      >
                    </div>
                  </div>
                </div>

                <div class="col-sm-4 col-6 padding-5">
                  <div class="form-group">
                    <label for="idVlrProdutos">Vlr Produtos</label>
                    <div class="input-group">
                      <span
                        class="form-control span-disable"
                        name="nameSpanVlrProdutos"
                        ngbTooltip="Campo calculado automaticamente, representa o somatorio dos produtos"
                        id="idVlrProdutos"
                        >{{
                          getVlrTotalProdutos() | number : "1.2-2" : "pt-BR"
                        }}</span
                      >
                    </div>
                  </div>
                </div>

                <div class="col-sm-4 col-6 padding-5">
                  <div class="form-group">
                    <label for="idVlrDescProdutos">Vlr Desc Produtos</label>
                    <div class="input-group">
                      <span
                        class="form-control span-disable"
                        name="nameSpanDescProdutos"
                        ngbTooltip="Campo calculado automaticamente, representa o somatorio dos desconotos aplicados nos produtos"
                        id="idVlrDescProdutos"
                        >{{
                          getVlrTotalDescProdutos() | number : "1.2-2" : "pt-BR"
                        }}</span
                      >
                    </div>
                  </div>
                </div>

                <div class="col-sm-3 col-6 padding-5">
                  <div class="form-group">
                    <!--
                                    <label for="idVlrAcrescCond">Vlr Acréscimo Cond</label>
                                    <div class="input-group">
                                        <span class="form-control span-disable" name="nmVlrAcrescCond"
                                            ngbTooltip="Campo calculado automaticamente, representa o ajuste baseado na condição de pagamento"
                                            id="idVlrAcrescCond">{{ getVlrTotalAcrescimoCondicao() | number:'1.2-2':'pt-BR' }}</span>
                                    </div>
                                -->
                    <label for="idVlrAcreCond">Vlr Acréscimo Cond</label>
                    <div class="input-group">
                      <input
                        type="number"
                        ngbTooltip="Campo de acréscimo de condição"
                        [ngClass]="{
                          'is-invalid':
                            submitted && f.vlrAcrescimoFixoCondicao.errors
                        }"
                        class="form-control"
                        id="idVlrAcreCond"
                        formControlName="vlrAcrescimoFixoCondicao"
                        inputmode="decimal"
                      />
                      <div
                        *ngIf="submitted && f.vlrAcrescimoFixoCondicao.errors"
                        class="invalid-feedback"
                      >
                        <div *ngIf="f.vlrAcrescimoFixoCondicao.errors['min']">
                          Valor deve ser maior que 0
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="col-sm-3 col-6 padding-5">
                  <div class="form-group">
                    <label for="idVlrFrete">Frete</label>
                    <div class="input-group">
                      <input
                        type="number"
                        ngbTooltip="Campo de acréscimo de frete"
                        [ngClass]="{
                          'is-invalid': submitted && f.vlrFrete.errors
                        }"
                        class="form-control"
                        id="idVlrFrete"
                        formControlName="vlrFrete"
                        inputmode="decimal"
                      />
                      <div
                        *ngIf="submitted && f.vlrFrete.errors"
                        class="invalid-feedback"
                      >
                        <div *ngIf="f.vlrFrete.errors['min']">
                          Valor deve ser maior que 0
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="col-sm-3 col-6 padding-5">
                  <div class="form-group">
                    <label for="idVlrDesAcessoria">Despesa Acessória</label>
                    <div class="input-group">
                      <input
                        type="number"
                        ngbTooltip="Campo de acréscimo de despesa Acessória"
                        [ngClass]="{
                          'is-invalid': submitted && f.vlrDespAcessoria.errors
                        }"
                        class="form-control"
                        id="idVlrDesAcessoria"
                        formControlName="vlrDespAcessoria"
                        inputmode="decimal"
                      />
                      <div
                        *ngIf="submitted && f.vlrDespAcessoria.errors"
                        class="invalid-feedback"
                      >
                        <div *ngIf="f.vlrDespAcessoria.errors['min']">
                          Valor deve ser maior que 0
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="col-sm-3 col-12 padding-5">
                  <div class="form-group">
                    <label for="idvlrDescontoGeral">Desconto Geral</label>
                    <div class="input-group">
                      <input
                        type="number"
                        ngbTooltip="ATENÇÃO - Campo de desconto geral"
                        [ngClass]="{
                          'is-invalid': submitted && f.vlrDescontoGeral.errors
                        }"
                        class="form-control"
                        id="idvlrDescontoGeral"
                        formControlName="vlrDescontoGeral"
                        inputmode="decimal"
                      />
                      <div
                        *ngIf="submitted && f.vlrDescontoGeral.errors"
                        class="invalid-feedback"
                      >
                        <div *ngIf="f.vlrDescontoGeral.errors['min']">
                          Valor deve ser maior que 0
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div
                  class="padding-5"
                  [ngClass]="
                    statusForm > 1 ? 'col-sm-6 col-6' : 'col-sm-4 col-12'
                  "
                  *ngIf="statusForm !== 1 && isBotaoConfirmar()"
                >
                  <div class="form-group">
                    <label for="idVlrTotalPreVendaOrig"
                      >Total Pré-Venda Orig</label
                    >
                    <div class="input-group">
                      <span
                        class="form-control span-disable"
                        name="nmVlrTotalPreVendaOrig"
                        ngbTooltip="Campo salvo automaticamente com o valor total da pré-venda"
                        id="idVlrTotalPreVendaOrig"
                        >{{
                          getVlrTotalPreVendaOrig() | number : "1.2-2" : "pt-BR"
                        }}</span
                      >
                    </div>
                  </div>
                </div>

                <div
                  class="col-sm-4 padding-5"
                  [ngClass]="
                    statusForm !== 1 && isBotaoConfirmar()
                      ? 'col-sm-6 col-6'
                      : 'col-sm-4 col-12'
                  "
                >
                  <div class="form-group">
                    <label for="idVlrTotalPreVenda">Total Pré-Venda</label>
                    <div class="input-group">
                      <span
                        class="form-control span-disable"
                        name="nameSpanTotalPreVenda"
                        ngbTooltip="Campo calculado automaticamente, representa o valor total da pré-venda"
                        id="idVlrTotalPreVenda"
                        >{{
                          getVlrTotalPreVenda() | number : "1.2-2" : "pt-BR"
                        }}</span
                      >
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
    <div *ngIf="statusForm === 3">
      <div class="card bg-light mb-3">
        <div class="card-header">Ações</div>
        <div class="card-body card-buttons">
          <div class="row">

            <div class="col-sm-3 col-6 div-mobile-buttons d-grid">
              <button
                type="button"
                class="btn btn-block btn-primary butao-acao"
                (click)="voltar()"
              >
                <span class="fa fa-arrow-left span-acao"></span> Voltar
              </button>
            </div>

            <div class="col-sm-3 col-6 div-mobile-buttons d-grid">
              <button
                type="button"
                class="btn btn-block btn-warning butao-acao"
                [disabled]="selected.length === 0"
                (click)="editando()"
              >
                <span class="fa fa-edit span-acao"></span> Editar
              </button>
            </div>
            
            <div class="col-sm-3 col-6 div-mobile-buttons d-grid"  *ngIf="isBotaoPrintSelected()">
              <button
                type="button"
                class="btn btn-block btn-outline-dark butao-acao"
                (click)="printAllSelected()"
              >
                <span class="fa fa-print span-acao"></span> Imprimir selecionados
              </button>
            </div>
            
            <div class="col-sm-3 col-6 div-mobile-buttons d-grid">
              <button
                type="button"
                class="btn btn-block btn-outline-dark butao-acao"
                (click)="selecionarTodasAsVendas()"
              >
                <span class="fa fa-check span-acao"></span>Selecionar todas
              </button>
            </div>

            <div class="col-sm-3 col-6 div-mobile-buttons d-grid" *ngIf="isBotaoFaturarTodos()">
              <button
                type="button"
                class="btn btn-block btn-outline-dark butao-acao"
                (click)="faturarTodos()"
              >
                <span class="fa fa-bolt span-acao"></span>Faturar todas
              </button>
            </div>


          </div>
        </div>
      </div>

      
      <ngx-datatable
        class="material"
        [scrollbarH]="true"
        [rows]="pageVenda.content"
        appResizeWatcher
        [columnMode]="ColumnMode.standard"
        [headerHeight]="35"
        [footerHeight]="70"
        rowHeight="auto"
        [selected]="selected"
        [selectionType]="selectionTypeSingle"
        [rowClass]="getRowClass"
        (activate)="onActivate($event)"
        [externalPaging]="true"
        [count]="pageVenda.totalElements"
        [offset]="pageVenda.pageable.pageNumber"
        [limit]="pageVenda.size"
        (page)="setPage($event)"
      >

      <ngx-datatable-column name="TRANSF" [width]="80">
          <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
              <div style="padding: 0px; margin: 0px; text-align: center;">
                  <input type="checkbox" id="checkIndBaixarId" name="checkIndBaixarNm"
                      style="padding: 0px;margin: 0px" [(ngModel)]="row.imprime">
              </div>
          </ng-template>
      </ngx-datatable-column>

        <ngx-datatable-column
          name="ID"
          prop="id"
          [width]="100"
        ></ngx-datatable-column>
        <ngx-datatable-column
          name="ORIGEM"
          prop="origem"
          [width]="100"
        ></ngx-datatable-column>

        <!--<ngx-datatable-column name="COD" prop="codPreVenda" [width]="110"></ngx-datatable-column>-->
        <ngx-datatable-column
          name="DATA INCLUSÃO"
          prop="dtaInclusao"
          [width]="130"
        >
          <ng-template let-value="value" ngx-datatable-cell-template>
            {{ value | amDateFormat : "DD/MM/YYYY HH:mm:ss" }}
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column
          name="USUÁRIO INCLUSÃO"
          prop="usuarioInclusao"
          [width]="110"
        ></ngx-datatable-column>
        <ngx-datatable-column
          name="DATA EMISSÃO"
          prop="dtaEmissao"
          [width]="110"
        >
          <ng-template let-value="value" ngx-datatable-cell-template>
            {{ value | amDateFormat : "DD/MM/YYYY" }}
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column
          name="DATA ENTREGA"
          prop="dtaEntrega"
          [width]="130"
        >
          <ng-template let-value="value" ngx-datatable-cell-template>
            {{ value | amDateFormat : "DD/MM/YYYY HH:mm:ss" }}
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column
          name="ALMOXARIFADO"
          prop="estoqueAlmoxarifadoNome"
          [width]="350"
        >
        </ngx-datatable-column>
        <ngx-datatable-column
        name="CIDADE ENTREGA"
        prop="municipioNome"
        [width]="300"
      >
      </ngx-datatable-column>

        <ngx-datatable-column name="STATUS" prop="status" [width]="300">
        </ngx-datatable-column>
        <ngx-datatable-column
          name="CONDIÇÃO"
          prop="condicaoPagamentoNome"
          [width]="200"
        ></ngx-datatable-column>

        <ngx-datatable-column
          name="CLI ID"
          prop="clienteId"
          [width]="50"
        ></ngx-datatable-column>
        <ngx-datatable-column
          name="CLIENTE"
          prop="clienteNome"
          [width]="400"
        ></ngx-datatable-column>
        <ngx-datatable-column
          name="VENDEDOR"
          prop="vendedorNome"
          [width]="350"
        ></ngx-datatable-column>
        <ngx-datatable-column name="VALOR TOTAL" prop="vlrTotal" [width]="130">
          <ng-template let-value="value" ngx-datatable-cell-template>
            {{ value | number : "1.2-2" : "pt-BR" }}
          </ng-template>
        </ngx-datatable-column>
      </ngx-datatable>
    </div>
  </div>
</div>
